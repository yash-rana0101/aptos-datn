"use strict";exports.id=904,exports.ids=[904],exports.modules={69882:(e,r,t)=>{t.d(r,{Dg:()=>d,Ir:()=>o,mC:()=>u,nM:()=>n,ry:()=>s,wv:()=>i});var l=t(87107),a=t(84644);let s=e=>{let{title:r,description:t,price:a,quantity:s,imageUrls:n,category:o}=e;return{data:{function:`${l.VB.PRODUCT}::create_product`,functionArguments:[r,t,a,s,n,o]},options:l.OI}},n=e=>{let{productAddress:r,title:t,description:a,price:s,imageUrls:n,category:o}=e;return{data:{function:`${l.VB.PRODUCT}::update_product`,functionArguments:[r,t||"",a||"",s||0,n||[],o||""]},options:l.OI}},o=e=>({data:{function:`${l.VB.PRODUCT}::delete_product`,functionArguments:[e]},options:l.OI}),i=async e=>{try{let r=await a.lV.view({payload:{function:`${l.VB.PRODUCT}::get_product`,functionArguments:[e]}});if(!r||0===r.length)return null;let[t,s,n,o,i,u,d,c,y,p,g,m]=r;return{productAddress:e,title:t,description:s,price:parseInt(n),quantity:parseInt(o),soldQuantity:parseInt(i),imageUrls:u,category:d,isAvailable:c,isDeleted:y,seller:p,createdAt:parseInt(g),updatedAt:parseInt(m)}}catch(e){return console.error("Error fetching product:",e),null}},u=async e=>{try{return(await a.lV.view({payload:{function:`${l.VB.PRODUCT}::get_seller_products`,functionArguments:[e]}}))[0]}catch(e){return console.error("Error fetching seller products:",e),[]}},d=async()=>{try{return(await a.lV.view({payload:{function:`${l.VB.PRODUCT}::get_all_products`,functionArguments:[]}}))[0]}catch(e){return console.error("Error fetching all products:",e),[]}}},59939:(e,r,t)=>{t.d(r,{EE:()=>p,gl:()=>a.gl,HF:()=>a.HF,Pt:()=>v,Aj:()=>y,iB:()=>a.iB,Cc:()=>w,HY:()=>a.HY,d_:()=>q,vO:()=>a.vO,Gn:()=>l.Gn,Gr:()=>l.Gr});var l=t(45027),a=t(39105),s=t(20108),n=t(57969);t(85999);var o=t(87107),i=t(84644);let u=async e=>{try{let r=await i.lV.view({payload:{function:`${o.VB.ORDER}::get_order`,functionArguments:[e]}});if(!r||0===r.length)return null;let[t,l,a,s,n,u,d,c,y,p,g,m]=r;return{orderAddress:e,orderId:parseInt(t),productAddress:l,buyerAddress:a,sellerAddress:s,quantity:parseInt(n),totalPrice:parseInt(u),shippingAddress:d,status:c,isPaid:y,createdAt:parseInt(p),updatedAt:parseInt(g),notes:m}}catch(e){return console.error("Error fetching order:",e),null}},d=async e=>{try{return(await i.lV.view({payload:{function:`${o.VB.ORDER}::get_buyer_orders`,functionArguments:[e]}}))[0]}catch(e){return console.error("Error fetching buyer orders:",e),[]}},c={all:["orders"],lists:()=>[...c.all,"list"],detail:e=>[...c.all,"detail",e],buyerOrders:e=>[...c.all,"buyer",e],sellerOrders:e=>[...c.all,"seller",e],status:e=>[...c.all,"status",e]},y=(e,r=!0)=>(0,s.a)({queryKey:c.detail(e),queryFn:()=>u(e),enabled:r&&!!e,staleTime:6e4}),p=e=>{let{account:r}=(0,n.Os)(),t=e||r?.address?.toString();return(0,s.a)({queryKey:c.buyerOrders(t||""),queryFn:()=>d(t),enabled:!!t,staleTime:12e4})},g=async e=>{try{let r=await i.lV.view({payload:{function:`${o.VB.ESCROW}::get_escrow_order`,functionArguments:[e]}});if(!r||0===r.length)return null;let[t,l,a,s,n,u,d,c,y,p,g,m,f,v,w]=r;return{escrowOrderAddress:e,orderId:parseInt(t),productAddress:l,buyerAddress:a,sellerAddress:s,quantity:parseInt(n),totalPrice:parseInt(u),lockedFunds:parseInt(d),shippingAddress:c,status:y,deliveryCode:p,receivingCode:g,transactionHash:m,createdAt:parseInt(f),deliveredAt:parseInt(v),confirmedAt:parseInt(w)}}catch(e){return console.error("Error fetching escrow order:",e),null}},m=async e=>{try{return(await i.lV.view({payload:{function:`${o.VB.ESCROW}::get_seller_escrow_orders`,functionArguments:[e]}}))[0]}catch(e){return console.error("Error fetching seller escrow orders:",e),[]}},f={all:["escrow"],lists:()=>[...f.all,"list"],detail:e=>[...f.all,"detail",e],buyerEscrows:e=>[...f.all,"buyer",e],sellerEscrows:e=>[...f.all,"seller",e],status:e=>[...f.all,"status",e],deliveryCode:e=>[...f.all,"deliveryCode",e],receivingCode:e=>[...f.all,"receivingCode",e]},v=(e,r=!0)=>(0,s.a)({queryKey:f.detail(e),queryFn:()=>g(e),enabled:r&&!!e,staleTime:6e4}),w=e=>{let{account:r}=(0,n.Os)(),t=e||r?.address?.toString();return(0,s.a)({queryKey:f.sellerEscrows(t||""),queryFn:()=>m(t),enabled:!!t,staleTime:12e4})};var A=t(69882);let q=e=>{let{account:r}=(0,n.Os)(),t=e||r?.address?.toString();return(0,s.a)({queryKey:["seller-products",t],queryFn:async()=>{if(!t)return[];let e=await (0,A.mC)(t);return(await Promise.all(e.map(e=>(0,A.wv)(e)))).filter(e=>null!==e&&!e.isDeleted)},enabled:!!t,staleTime:3e4})}},39105:(e,r,t)=>{t.d(r,{BX:()=>c,HF:()=>m,HY:()=>y,gl:()=>p,iB:()=>d,vO:()=>g});var l=t(20108),a=t(44976),s=t(10119),n=t(57969),o=t(85999),i=t(69882);let u={all:["products"],lists:()=>[...u.all,"list"],detail:e=>[...u.all,"detail",e],sellerProducts:e=>[...u.all,"seller",e],availability:e=>[...u.all,"availability",e],stock:(e,r)=>[...u.all,"stock",e,r],price:e=>[...u.all,"price",e]},d=(e,r=!0)=>(0,l.a)({queryKey:u.detail(e),queryFn:()=>i.wv(e),enabled:r&&!!e,staleTime:12e4}),c=()=>(0,l.a)({queryKey:u.lists(),queryFn:async()=>{try{let e=await i.Dg();if(!e||0===e.length)return[];let r=e.map(e=>i.wv(e));return(await Promise.all(r)).filter(e=>null!==e&&!e.isDeleted&&e.isAvailable).map(e=>({id:e.productAddress,name:e.title,description:e.description,price:e.price,images:e.imageUrls,category:e.category,isAvailable:e.isAvailable,quantity:e.quantity,createdAt:e.createdAt.toString(),updatedAt:e.updatedAt.toString(),user:{name:"Seller",role:"seller"}}))}catch(e){return console.error("Error fetching all products:",e),[]}},staleTime:3e5}),y=e=>{let{account:r}=(0,n.Os)(),t=e||r?.address?.toString();return(0,l.a)({queryKey:u.sellerProducts(t||""),queryFn:()=>i.mC(t),enabled:!!t,staleTime:3e5})},p=()=>{let e=(0,a.NL)(),{account:r,signAndSubmitTransaction:t}=(0,n.Os)();return(0,s.D)({mutationFn:async e=>{if(!r)throw Error("Wallet not connected");let l=i.ry(e);return await t(l)},onSuccess:()=>{r?.address&&e.invalidateQueries({queryKey:u.sellerProducts(r.address.toString())}),e.invalidateQueries({queryKey:u.lists()}),o.Am.success("Product created successfully!")},onError:e=>{o.Am.error(e.message||"Failed to create product"),console.error("Create product error:",e)}})},g=()=>{let e=(0,a.NL)(),{account:r,signAndSubmitTransaction:t}=(0,n.Os)();return(0,s.D)({mutationFn:async e=>{if(!r)throw Error("Wallet not connected");let l=i.nM(e);return await t(l)},onSuccess:(t,l)=>{e.invalidateQueries({queryKey:u.detail(l.productAddress)}),r?.address&&e.invalidateQueries({queryKey:u.sellerProducts(r.address.toString())}),o.Am.success("Product updated successfully!")},onError:e=>{o.Am.error(e.message||"Failed to update product"),console.error("Update product error:",e)}})},m=()=>{let e=(0,a.NL)(),{account:r,signAndSubmitTransaction:t}=(0,n.Os)();return(0,s.D)({mutationFn:async e=>{if(!r)throw Error("Wallet not connected");let l=i.Ir(e);return await t(l)},onSuccess:(t,l)=>{e.invalidateQueries({queryKey:u.detail(l)}),r?.address&&e.invalidateQueries({queryKey:u.sellerProducts(r.address.toString())}),e.invalidateQueries({queryKey:u.lists()}),o.Am.success("Product deleted successfully!")},onError:e=>{o.Am.error(e.message||"Failed to delete product"),console.error("Delete product error:",e)}})}},73881:(e,r,t)=>{t.r(r),t.d(r,{default:()=>a});var l=t(66621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,l.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};