(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[609],{5024:function(){},108:function(e,t,r){"use strict";r.d(t,{IB:function(){return o},OI:function(){return i},VB:function(){return a},n2:function(){return c},pR:function(){return l}});var n=r(357);let o="testnet",u="0x9f10b1c09f496745b7c56c82d6648dcb2c5de24ffc95e39aec8b32a655b42d51",c=n.env.NEXT_PUBLIC_APTOS_API_KEY,a={USER_PROFILE:"".concat(u,"::user_profile"),PRODUCT:"".concat(u,"::product"),ORDER:"".concat(u,"::order"),ESCROW:"".concat(u,"::escrow")},l={BUYER:1,SELLER:2},i={maxGasAmount:2e5,gasUnitPrice:100}},2752:function(e,t,r){"use strict";r.d(t,{lV:function(){return c}});var n=r(1409),o=r(108);let u=new n.ScN("local"===o.IB?{network:"custom",fullnode:"http://localhost:8080",faucet:"http://localhost:8081"}:{network:o.IB,...o.n2&&{clientConfig:{API_KEY:o.n2}}}),c=new n.gZG(u)},9914:function(e,t,r){"use strict";r.d(t,{Dg:function(){return s},Ir:function(){return a},mC:function(){return i},nM:function(){return c},ry:function(){return u},wv:function(){return l}});var n=r(108),o=r(2752);let u=e=>{let{title:t,description:r,price:o,quantity:u,imageUrls:c,category:a}=e;return{data:{function:"".concat(n.VB.PRODUCT,"::create_product"),functionArguments:[t,r,o,u,c,a]},options:n.OI}},c=e=>{let{productAddress:t,title:r,description:o,price:u,imageUrls:c,category:a}=e;return{data:{function:"".concat(n.VB.PRODUCT,"::update_product"),functionArguments:[t,r||"",o||"",u||0,c||[],a||""]},options:n.OI}},a=e=>({data:{function:"".concat(n.VB.PRODUCT,"::delete_product"),functionArguments:[e]},options:n.OI}),l=async e=>{try{let t=await o.lV.view({payload:{function:"".concat(n.VB.PRODUCT,"::get_product"),functionArguments:[e]}});if(!t||0===t.length)return null;let[r,u,c,a,l,i,s,d,f,p,y,g]=t;return{productAddress:e,title:r,description:u,price:parseInt(c),quantity:parseInt(a),soldQuantity:parseInt(l),imageUrls:i,category:s,isAvailable:d,isDeleted:f,seller:p,createdAt:parseInt(y),updatedAt:parseInt(g)}}catch(e){return console.error("Error fetching product:",e),null}},i=async e=>{try{return(await o.lV.view({payload:{function:"".concat(n.VB.PRODUCT,"::get_seller_products"),functionArguments:[e]}}))[0]}catch(e){return console.error("Error fetching seller products:",e),[]}},s=async()=>{try{return(await o.lV.view({payload:{function:"".concat(n.VB.PRODUCT,"::get_all_products"),functionArguments:[]}}))[0]}catch(e){return console.error("Error fetching all products:",e),[]}}},4903:function(e,t,r){"use strict";r.d(t,{BX:function(){return d},HF:function(){return g},HY:function(){return f},gl:function(){return p},iB:function(){return s},vO:function(){return y}});var n=r(5118),o=r(3191),u=r(5524),c=r(7693),a=r(7776),l=r(9914);let i={all:["products"],lists:()=>[...i.all,"list"],detail:e=>[...i.all,"detail",e],sellerProducts:e=>[...i.all,"seller",e],availability:e=>[...i.all,"availability",e],stock:(e,t)=>[...i.all,"stock",e,t],price:e=>[...i.all,"price",e]},s=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,n.a)({queryKey:i.detail(e),queryFn:()=>l.wv(e),enabled:t&&!!e,staleTime:12e4})},d=()=>(0,n.a)({queryKey:i.lists(),queryFn:async()=>{try{let e=await l.Dg();if(!e||0===e.length)return[];let t=e.map(e=>l.wv(e));return(await Promise.all(t)).filter(e=>null!==e&&!e.isDeleted&&e.isAvailable).map(e=>({id:e.productAddress,name:e.title,description:e.description,price:e.price,images:e.imageUrls,category:e.category,isAvailable:e.isAvailable,quantity:e.quantity,createdAt:e.createdAt.toString(),updatedAt:e.updatedAt.toString(),user:{name:"Seller",role:"seller"}}))}catch(e){return console.error("Error fetching all products:",e),[]}},staleTime:3e5}),f=e=>{var t;let{account:r}=(0,c.Os)(),o=e||(null==r?void 0:null===(t=r.address)||void 0===t?void 0:t.toString());return(0,n.a)({queryKey:i.sellerProducts(o||""),queryFn:()=>l.mC(o),enabled:!!o,staleTime:3e5})},p=()=>{let e=(0,o.NL)(),{account:t,signAndSubmitTransaction:r}=(0,c.Os)();return(0,u.D)({mutationFn:async e=>{if(!t)throw Error("Wallet not connected");let n=l.ry(e);return await r(n)},onSuccess:()=>{(null==t?void 0:t.address)&&e.invalidateQueries({queryKey:i.sellerProducts(t.address.toString())}),e.invalidateQueries({queryKey:i.lists()}),a.Am.success("Product created successfully!")},onError:e=>{a.Am.error(e.message||"Failed to create product"),console.error("Create product error:",e)}})},y=()=>{let e=(0,o.NL)(),{account:t,signAndSubmitTransaction:r}=(0,c.Os)();return(0,u.D)({mutationFn:async e=>{if(!t)throw Error("Wallet not connected");let n=l.nM(e);return await r(n)},onSuccess:(r,n)=>{e.invalidateQueries({queryKey:i.detail(n.productAddress)}),(null==t?void 0:t.address)&&e.invalidateQueries({queryKey:i.sellerProducts(t.address.toString())}),a.Am.success("Product updated successfully!")},onError:e=>{a.Am.error(e.message||"Failed to update product"),console.error("Update product error:",e)}})},g=()=>{let e=(0,o.NL)(),{account:t,signAndSubmitTransaction:r}=(0,c.Os)();return(0,u.D)({mutationFn:async e=>{if(!t)throw Error("Wallet not connected");let n=l.Ir(e);return await r(n)},onSuccess:(r,n)=>{e.invalidateQueries({queryKey:i.detail(n)}),(null==t?void 0:t.address)&&e.invalidateQueries({queryKey:i.sellerProducts(t.address.toString())}),e.invalidateQueries({queryKey:i.lists()}),a.Am.success("Product deleted successfully!")},onError:e=>{a.Am.error(e.message||"Failed to delete product"),console.error("Delete product error:",e)}})}}}]);